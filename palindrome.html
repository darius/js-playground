<html><head>
  <title>Palindrome me</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head><body>
  <h1>Yay</h1>
  <script>
    // These are filled in by count_big.js, which can take a while to load.
    var NT = 100, vocab = {"the":1}, maxWordLength = 3;
  </script>
  <script src="palindrome.jpp.js"></script>
  <script src="dom.js"></script>

  <form name="palin" method="get" action="palin.html">
  <p>Type here.</p>
  <p>Whee: <input type="text" name="input" id="textfield"/></p>
  </form>

  <div id="output">...</div>

  <script type="text/javascript">

    var palin = document.forms.palin;
    var input = palin.elements.input;
    input.focus();

    // Total hack alert: when we're notified of the keypress event,
    // input.value hasn't yet been updated. So we schedule our update
    // for after. Surely there's a better way, such as a different event
    // to react to?

    var output = $("output");
    function updateOutput() {
        var outputNode = document.createTextNode(complete(input.value));
        output.replaceChild(outputNode, output.firstChild);
    }
    function updateOutputSoon(event) {
        setTimeout(updateOutput, 10);
    }
    registerEventHandler($("textfield"), "keypress", updateOutputSoon);

  </script>
  <script src="count_big.js"></script>
</body></html>
